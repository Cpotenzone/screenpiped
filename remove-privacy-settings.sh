#!/bin/bash
# Guide to remove all Screenpipe privacy settings

echo "üîí REMOVE SCREENPIPE FROM PRIVACY SETTINGS"
echo "=========================================="
echo ""
echo "‚ö†Ô∏è  This MUST be done manually - macOS doesn't allow automated removal"
echo ""
echo "Follow these steps:"
echo ""
echo "1Ô∏è‚É£  SCREEN RECORDING"
echo "   ‚Ä¢ Open System Preferences ‚Üí Security & Privacy ‚Üí Screen Recording"
echo "   ‚Ä¢ Look for ALL entries containing 'screenpipe' or 'screenpipe-app'"
echo "   ‚Ä¢ Click the lock üîí to unlock (enter password)"
echo "   ‚Ä¢ Select each screenpipe entry and click the - button"
echo "   ‚Ä¢ Common entries:"
echo "     - screenpipe"
echo "     - screenpipe-app"
echo "     - screenpipe (multiple versions)"
echo "     - target/release/screenpipe-app"
echo "     - target/debug/screenpipe-app"
echo ""
echo "2Ô∏è‚É£  MICROPHONE"
echo "   ‚Ä¢ Open System Preferences ‚Üí Security & Privacy ‚Üí Microphone"
echo "   ‚Ä¢ Click the lock üîí to unlock"
echo "   ‚Ä¢ Remove ALL screenpipe entries"
echo ""
echo "3Ô∏è‚É£  ACCESSIBILITY (if present)"
echo "   ‚Ä¢ Open System Preferences ‚Üí Security & Privacy ‚Üí Accessibility"
echo "   ‚Ä¢ Click the lock üîí to unlock"
echo "   ‚Ä¢ Remove any screenpipe entries"
echo ""
echo "4Ô∏è‚É£  FULL DISK ACCESS (if present)"
echo "   ‚Ä¢ Open System Preferences ‚Üí Security & Privacy ‚Üí Full Disk Access"
echo "   ‚Ä¢ Click the lock üîí to unlock"
echo "   ‚Ä¢ Remove any screenpipe entries"
echo ""
echo "5Ô∏è‚É£  LOGIN ITEMS"
echo "   ‚Ä¢ Open System Preferences ‚Üí Users & Groups ‚Üí Login Items"
echo "   ‚Ä¢ Remove any screenpipe entries"
echo ""
echo "üìã Quick Access:"
echo "   Press: System Preferences ‚Üí Security & Privacy"
echo "   Or run: open x-apple.systempreferences:com.apple.preference.security"
echo ""
echo "‚úÖ After removing all entries, you're ready for a fresh install!"
echo ""
echo "üí° TIP: Look carefully - there might be 10-20 duplicate entries!"
echo ""

# Open System Preferences to the right location
read -p "Open Security & Privacy settings now? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    open "x-apple.systempreferences:com.apple.preference.security?Privacy_ScreenCapture"
    echo ""
    echo "‚úÖ Opened Screen Recording settings"
    echo "   After cleaning Screen Recording, manually navigate to Microphone tab"
fi
